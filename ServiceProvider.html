<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sanad - Provider Dashboard</title>
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link id="theme-style" rel="stylesheet" href="style-light.css">
</head>

<body class="sp-page">
  <!-- Navbar -->
  <header class="navbar">
    <div class="nav-container">
      <div class="nav-logo">
        <a href="index.html">
          <img src="images/sanad.png" alt="sanad logo">
        </a>
      </div>

      <nav class="nav-links">
        <a href="index.html">Home</a>
        <a href="services.html" class="border-left">Services</a>
        <a href="customer-dashboard.html" class="border-left">Customer</a>
        <a href="ServiceProvider.html" class="current border-left">Service Provider</a>
        <a href="about.html" class="border-left">About Us</a>
      </nav>
    </div>
  </header>

  <div class="nav-line"></div>

  <!-- Breadcrumbs -->
  <nav class="breadcrumbs dark">
    <ol class="trail nav-container">
      <li><a href="index.html">Home</a></li>
      <li>&gt;</li>
      <li>Service Provider</li>
    </ol>
  </nav>

  <!-- Main content -->
  <main class="container">
    <section class="page-title-container">
      <h1 class="page-title">Seller</h1>
    </section>



    
	<section>
      <h2 class="cards-title">List of services:</h2>
	  <div class="services-list"></div> 
    </section>
   

    <hr class="divider" style="margin-top:32px">

    <!-- Actions -->
    <div class="dashboard-actions">
      <a class="action-button" href="manage-staff.html">Manage Staff Member</a>
      <a class="action-button" href="addService.html">Add a New Service</a>
    </div>
  </main>

  <!-- Footer -->
  <footer class="site-footer">
    <div class="container footer-box">
      <div class="footer-grid">
        <div class="footer-col">
          <h4>Find us</h4>
          <ul class="social">
            <li><a href="#" aria-label="X">X</a></li>
            <li><a href="#" aria-label="Facebook">f</a></li>
            <li><a href="#" aria-label="LinkedIn">in</a></li>
          </ul>
        </div>

        <div class="footer-col center">
          <div class="brand">
            <img src="images/sanad.png" alt="Sanad logo">
          </div>
          <small>Â©2025 Sanad. All rights reserved</small>
        </div>

        <div class="footer-col right">
          <h4>contact Info</h4>
          <p>+966537282741</p>
          <p><a href="mailto:sanadservices@gmail.com">sanadservices@gmail.com</a></p>
        </div>
      </div>
    </div>
  </footer>
  
<script src="theme.js"></script>
  <script>
 document.addEventListener("DOMContentLoaded", function () {
  const services = JSON.parse(localStorage.getItem("services")) || [];
  console.log(services); 
  
  const container = document.querySelector(".services-list");

  services.forEach((service, index) => {
    const card = document.createElement("div");
    card.classList.add("service-card");
    card.dataset.index = index;
    
    // Check if service has a photo
    const photoHTML = service.photo 
      ? `<img src="${service.photo}" alt="${service.name}" style="width: 100%; height: 160px; object-fit: cover; border-radius: 10px; margin-bottom: 10px;">`
      : `<div style="width: 100%; height: 160px; background: #f0f0f0; border-radius: 10px; margin-bottom: 10px; display: flex; align-items: center; justify-content: center; color: #666;">No Image</div>`;
    
    card.innerHTML = `
      <div class="card-body">
        ${photoHTML}
        <div class="card-header">
          <h3 class="name-row">${service.name}</h3>
          <div class="price-badge">${service.price} SR</div>
        </div>
        <div class="quantity-row">
          <span class="label">Quantity:</span> #1
        </div>
        <div class="row">
          <span class="label">Description:</span> ${service.description}
        </div>
      <div style="display: flex; justify-content: flex-start; gap: 10px; margin-top: 10px;">
    <button class="btn btn-dark edit-btn" data-index="${index}">Edit</button>
    <button class="btn btn-dark danger delete-btn" data-index="${index}">Delete</button>
</div>
    `;

    container.appendChild(card);
  });

  // EDIT BUTTON HANDLER
  container.addEventListener("click", function(e) {
    if (e.target.classList.contains("edit-btn")) {
      e.preventDefault();

      const index = e.target.dataset.index;
      const service = services[index];
      
      if (service) {
        console.log("Editing service:", service);
        
        // Save the service data AND the index for editing
        localStorage.setItem("edit_index", index);
        localStorage.setItem("edit_name", service.name);
        localStorage.setItem("edit_price", service.price);
        localStorage.setItem("edit_description", service.description);
        
        // Go to edit page
        window.location.href = "editService.html";
      }
    }
    // DELETE BUTTON HANDLER
    container.addEventListener("click", function(e) {

  if (e.target.classList.contains("edit-btn")) {
    e.preventDefault();

    const index = e.target.dataset.index;
    const service = services[index];
    
    if (service) {
      console.log("Editing service:", service);
      
      // Save the service data AND the index for editing
      localStorage.setItem("edit_index", index);
      localStorage.setItem("edit_name", service.name);
      localStorage.setItem("edit_price", service.price);
      localStorage.setItem("edit_description", service.description);
      
      // Go to edit page
      window.location.href = "editService.html";
    }
  }

  if (e.target.classList.contains("delete-btn")) {
    e.preventDefault();

    const index = Number(e.target.dataset.index);

    const confirmDelete = confirm("Do you want to delete this service?");
    if (!confirmDelete) {
      return;
    }

    services.splice(index, 1);

    localStorage.setItem("services", JSON.stringify(services));

    location.reload();
  }
});

  });

  // CHECK FOR UPDATED SERVICES WHEN PAGE LOADS
  const updatedName = localStorage.getItem("updated_name");

  if (updatedName) {
    const updatedIndex = localStorage.getItem("updated_index");
    const updatedPrice = localStorage.getItem("updated_price");
    const updatedDesc = localStorage.getItem("updated_description");
    const updatedPhoto = localStorage.getItem("updated_photo"); // Get updated photo

    console.log("Found updated service:", updatedName, "at index:", updatedIndex);

    if (updatedIndex !== null && services[updatedIndex]) {
      // Update the service in the array
      services[updatedIndex].name = updatedName;
      services[updatedIndex].price = updatedPrice;
      services[updatedIndex].description = updatedDesc;
      
      // Update photo only if a new one was provided
      if (updatedPhoto) {
        services[updatedIndex].photo = updatedPhoto;
      }

      // Save the updated array back to localStorage
      localStorage.setItem("services", JSON.stringify(services));

      // Clear storage after applying updates
      localStorage.removeItem("updated_name");
      localStorage.removeItem("updated_price");
      localStorage.removeItem("updated_description");
      localStorage.removeItem("updated_photo");
      localStorage.removeItem("updated_index");

      // Reload the page to show the updated services
      setTimeout(() => {
        location.reload();
      }, 100);
    }
  }
});
</script>

</body>
</html>
